# ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ KOE006 ì—ëŸ¬ í•´ê²° ê°€ì´ë“œ

**ì—ëŸ¬ ì½”ë“œ**: KOE006 - Invalid redirect_uri
**ì›ì¸**: ì¹´ì¹´ì˜¤ ê°œë°œì ì½˜ì†”ì— ë“±ë¡ëœ Redirect URIì™€ ì‹¤ì œ ìš”ì²­ URIê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŒ

---

## ğŸ”´ KOE006 ì—ëŸ¬ë€?

**ì—ëŸ¬ ë©”ì‹œì§€**:
```
KOE006: invalid_request
Redirect URI mismatch
```

**ë°œìƒ ì›ì¸**:
- ì¹´ì¹´ì˜¤ OAuth ìš”ì²­ ì‹œ ì‚¬ìš©í•˜ëŠ” `redirect_uri`ê°€ ì¹´ì¹´ì˜¤ ê°œë°œì ì½˜ì†”ì— ë“±ë¡ë˜ì–´ ìˆì§€ ì•ŠìŒ
- URL í˜•ì‹ì´ ì •í™•íˆ ì¼ì¹˜í•˜ì§€ ì•ŠìŒ (http/https, ìŠ¬ë˜ì‹œ, ëŒ€ì†Œë¬¸ì ë“±)

---

## âœ… í•´ê²° ë°©ë²•

### 1ë‹¨ê³„: í˜„ì¬ ì‚¬ìš© ì¤‘ì¸ Redirect URI í™•ì¸

**ì›¹ í™˜ê²½**:
```javascript
// src/utils/socialAuth.jsì˜ 68ë²ˆì§¸ ì¤„
const REDIRECT_URI = await getRedirectUrl()

// ì›¹ì—ì„œëŠ”:
// http://localhost:5173/auth/callback (ê°œë°œ)
// https://your-domain.com/auth/callback (í”„ë¡œë•ì…˜)
```

**ëª¨ë°”ì¼ í™˜ê²½**:
```javascript
// iOS/Android:
// ingk://auth/callback
```

**í˜„ì¬ í”„ë¡œì íŠ¸ì˜ Redirect URI í™•ì¸ ë°©ë²•**:
1. ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬ ì—´ê¸° (F12)
2. Console íƒ­ì—ì„œ ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ì‹œë„
3. ì½˜ì†”ì— ì¶œë ¥ë˜ëŠ” "Kakao callback - Redirect URI" í™•ì¸

---

### 2ë‹¨ê³„: ì¹´ì¹´ì˜¤ ê°œë°œì ì½˜ì†” ì„¤ì •

#### ğŸ“ ì¹´ì¹´ì˜¤ ê°œë°œì ì½˜ì†” ì ‘ì†

1. **[Kakao Developers](https://developers.kakao.com)** ì ‘ì†
2. ë¡œê·¸ì¸
3. **ë‚´ ì• í”Œë¦¬ì¼€ì´ì…˜** ì„ íƒ

#### ğŸ“ Redirect URI ë“±ë¡

1. **ì œí’ˆ ì„¤ì •** â†’ **ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸** í´ë¦­
2. **Redirect URI** ì„¹ì…˜ìœ¼ë¡œ ìŠ¤í¬ë¡¤
3. **Redirect URI ë“±ë¡** ë²„íŠ¼ í´ë¦­
4. ë‹¤ìŒ URIë“¤ì„ **ì •í™•íˆ** ì…ë ¥:

**ê°œë°œ í™˜ê²½**:
```
http://localhost:5173/auth/callback
```

**í”„ë¡œë•ì…˜ í™˜ê²½** (Vercel):
```
https://your-domain.vercel.app/auth/callback
```

**ëª¨ë°”ì¼ ì•±**:
```
ingk://auth/callback
```

#### âš ï¸ ì£¼ì˜ì‚¬í•­

| í•­ëª© | ì˜¬ë°”ë¥¸ ì˜ˆ | ì˜ëª»ëœ ì˜ˆ |
|------|-----------|-----------|
| **í”„ë¡œí† ì½œ** | `https://` | `http://` (í”„ë¡œë•ì…˜) |
| **ìŠ¬ë˜ì‹œ** | `/auth/callback` | `/auth/callback/` âŒ |
| **ëŒ€ì†Œë¬¸ì** | `/auth/callback` | `/Auth/Callback` âŒ |
| **í¬íŠ¸** | `:5173` (ê°œë°œ) | ìƒëµ ë˜ëŠ” ë‹¤ë¥¸ í¬íŠ¸ âŒ |

---

### 3ë‹¨ê³„: í™˜ê²½ ë³€ìˆ˜ í™•ì¸

**`.env` íŒŒì¼ í™•ì¸**:

```env
# Kakao OAuth
VITE_KAKAO_CLIENT_ID=your_rest_api_key_here
VITE_KAKAO_CLIENT_SECRET=your_client_secret_here
```

**REST API í‚¤ í™•ì¸**:
1. ì¹´ì¹´ì˜¤ ê°œë°œì ì½˜ì†” â†’ **ë‚´ ì• í”Œë¦¬ì¼€ì´ì…˜**
2. **ì•± ì„¤ì •** â†’ **ì•± í‚¤**
3. **REST API í‚¤** ë³µì‚¬
4. `.env` íŒŒì¼ì˜ `VITE_KAKAO_CLIENT_ID`ì— ë¶™ì—¬ë„£ê¸°

**Client Secret í™•ì¸** (ì„ íƒì‚¬í•­, ë³´ì•ˆ ê°•í™”):
1. **ì œí’ˆ ì„¤ì •** â†’ **ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸** â†’ **ë³´ì•ˆ**
2. **Client Secret** â†’ **ì½”ë“œ ìƒì„±** í´ë¦­
3. ìƒì„±ëœ Secretì„ **í™œì„±í™”** ìƒíƒœë¡œ ë³€ê²½
4. `.env` íŒŒì¼ì˜ `VITE_KAKAO_CLIENT_SECRET`ì— ë¶™ì—¬ë„£ê¸°

---

### 4ë‹¨ê³„: í”Œë«í¼ ë“±ë¡ í™•ì¸

ì¹´ì¹´ì˜¤ëŠ” ì‚¬ìš©í•˜ëŠ” í”Œë«í¼ì„ ì‚¬ì „ì— ë“±ë¡í•´ì•¼ í•©ë‹ˆë‹¤.

#### ì›¹ í”Œë«í¼

1. **ì•± ì„¤ì •** â†’ **í”Œë«í¼**
2. **Web í”Œë«í¼ ë“±ë¡** í´ë¦­
3. **ì‚¬ì´íŠ¸ ë„ë©”ì¸** ì…ë ¥:
   ```
   http://localhost:5173 (ê°œë°œ)
   https://your-domain.vercel.app (í”„ë¡œë•ì…˜)
   ```

#### iOS í”Œë«í¼

1. **ì•± ì„¤ì •** â†’ **í”Œë«í¼**
2. **iOS í”Œë«í¼ ë“±ë¡** í´ë¦­
3. ì •ë³´ ì…ë ¥:
   - **ë²ˆë“¤ ID**: `com.tongchalban.community`
   - **Team ID**: Xcodeì—ì„œ í™•ì¸

#### Android í”Œë«í¼

1. **ì•± ì„¤ì •** â†’ **í”Œë«í¼**
2. **Android í”Œë«í¼ ë“±ë¡** í´ë¦­
3. ì •ë³´ ì…ë ¥:
   - **íŒ¨í‚¤ì§€ëª…**: `com.tongchalban.community`
   - **ë§ˆì¼“ URL**: Play Store URL (ì„ íƒ)
   - **í‚¤ í•´ì‹œ**: `keytool` ëª…ë ¹ì–´ë¡œ ìƒì„±

---

## ğŸ§ª í…ŒìŠ¤íŠ¸

### ì›¹ í…ŒìŠ¤íŠ¸

1. **ê°œë°œ ì„œë²„ ì‹¤í–‰**:
   ```bash
   npm run dev
   ```

2. **ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ì‹œë„**:
   - http://localhost:5173/login ì ‘ì†
   - "ì¹´ì¹´ì˜¤ë¡œ ê³„ì†í•˜ê¸°" ë²„íŠ¼ í´ë¦­

3. **ì½˜ì†” í™•ì¸**:
   ```
   Kakao callback - Redirect URI: http://localhost:5173/auth/callback
   ```

4. **ì—ëŸ¬ ì—†ì´ ë¡œê·¸ì¸ ì„±ê³µ**í•˜ë©´ í•´ê²°ë¨!

### ëª¨ë°”ì¼ í…ŒìŠ¤íŠ¸

1. **ë¹Œë“œ ë° ë™ê¸°í™”**:
   ```bash
   npm run build
   npx cap sync
   ```

2. **iOS í…ŒìŠ¤íŠ¸**:
   ```bash
   npx cap open ios
   ```
   - Xcodeì—ì„œ ì‹¤í–‰
   - ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ì‹œë„

3. **Android í…ŒìŠ¤íŠ¸**:
   ```bash
   npx cap open android
   ```
   - Android Studioì—ì„œ ì‹¤í–‰
   - ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ì‹œë„

---

## ğŸ“‹ ì„¤ì • ì²´í¬ë¦¬ìŠ¤íŠ¸

ì™„ë£Œ ì—¬ë¶€ë¥¼ í™•ì¸í•˜ì„¸ìš”:

### ì¹´ì¹´ì˜¤ ê°œë°œì ì½˜ì†”
- [ ] ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒì„±ë¨
- [ ] ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ í™œì„±í™”ë¨
- [ ] Redirect URI ë“±ë¡ (ê°œë°œ):
  - [ ] `http://localhost:5173/auth/callback`
- [ ] Redirect URI ë“±ë¡ (í”„ë¡œë•ì…˜):
  - [ ] `https://your-domain.vercel.app/auth/callback`
- [ ] Redirect URI ë“±ë¡ (ëª¨ë°”ì¼):
  - [ ] `ingk://auth/callback`
- [ ] ì›¹ í”Œë«í¼ ë“±ë¡ (ê°œë°œ):
  - [ ] `http://localhost:5173`
- [ ] ì›¹ í”Œë«í¼ ë“±ë¡ (í”„ë¡œë•ì…˜):
  - [ ] `https://your-domain.vercel.app`
- [ ] ë™ì˜í•­ëª© ì„¤ì •:
  - [ ] ì´ë©”ì¼: í•„ìˆ˜
  - [ ] í”„ë¡œí•„ ì •ë³´: í•„ìˆ˜

### í”„ë¡œì íŠ¸ ì„¤ì •
- [ ] `.env` íŒŒì¼ì— `VITE_KAKAO_CLIENT_ID` ì„¤ì •
- [ ] `.env` íŒŒì¼ì— `VITE_KAKAO_CLIENT_SECRET` ì„¤ì • (ì„ íƒ)
- [ ] REST API í‚¤ê°€ ì •í™•í•¨
- [ ] í™˜ê²½ ë³€ìˆ˜ ì¬ë¡œë“œ (ì„œë²„ ì¬ì‹œì‘)

### ëª¨ë°”ì¼ ì„¤ì • (í•´ë‹¹ ì‹œ)
- [ ] iOS: `Info.plist`ì— URL Scheme ì¶”ê°€
- [ ] Android: `AndroidManifest.xml`ì— Intent Filter ì¶”ê°€
- [ ] Capacitor ë™ê¸°í™” ì™„ë£Œ

---

## ğŸ” ì¶”ê°€ ë””ë²„ê¹…

### ì½˜ì†” ë¡œê·¸ í™•ì¸

ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ì‹œë„ ì‹œ ë‹¤ìŒ ë¡œê·¸ë¥¼ í™•ì¸:

```javascript
// 1. Redirect URI í™•ì¸
Kakao callback - Redirect URI: http://localhost:5173/auth/callback

// 2. Authorization Code í™•ì¸
Kakao callback - Code: abc123...

// 3. Token êµí™˜ í™•ì¸
Kakao token response: {access_token: "...", ...}
```

### ë„¤íŠ¸ì›Œí¬ íƒ­ í™•ì¸

1. ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬ â†’ Network íƒ­
2. ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ì‹œë„
3. `https://kauth.kakao.com/oauth/authorize` ìš”ì²­ í™•ì¸
4. Query Parametersì—ì„œ `redirect_uri` ê°’ í™•ì¸

### ì¼ë°˜ì ì¸ ì‹¤ìˆ˜

| ì‹¤ìˆ˜ | ì„¤ëª… | í•´ê²° |
|------|------|------|
| **í”„ë¡œí† ì½œ ë¶ˆì¼ì¹˜** | ê°œë°œì€ `http`, í”„ë¡œë•ì…˜ì€ `https` | ê°ê° ë“±ë¡ |
| **í¬íŠ¸ ë²ˆí˜¸ ëˆ„ë½** | `localhost` vs `localhost:5173` | ì •í™•íˆ ì¼ì¹˜ |
| **ìŠ¬ë˜ì‹œ ì¶”ê°€** | `/auth/callback/` | ìŠ¬ë˜ì‹œ ì œê±° |
| **í™˜ê²½ ë³€ìˆ˜ ë¯¸ë°˜ì˜** | ì„œë²„ ì¬ì‹œì‘ ì•ˆí•¨ | `npm run dev` ì¬ì‹¤í–‰ |
| **ëŒ€ì†Œë¬¸ì** | `/Auth/Callback` | ì†Œë¬¸ì ì‚¬ìš© |

---

## ğŸ†˜ ì—¬ì „íˆ í•´ê²° ì•ˆ ë˜ë©´?

### 1. ì¹´ì¹´ì˜¤ ê°œë°œì ì½˜ì†” ì¬í™•ì¸

```
ì¹´ì¹´ì˜¤ ê°œë°œì ì½˜ì†” â†’ ë‚´ ì• í”Œë¦¬ì¼€ì´ì…˜ â†’ ì œí’ˆ ì„¤ì • â†’ ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸
â†’ Redirect URI ì„¹ì…˜ì—ì„œ ë“±ë¡ëœ URI ëª©ë¡ í™•ì¸
```

### 2. ë¸Œë¼ìš°ì € ìºì‹œ ì‚­ì œ

```
Ctrl+Shift+Delete (Windows)
Cmd+Shift+Delete (Mac)
â†’ ìºì‹œëœ ì´ë¯¸ì§€ ë° íŒŒì¼ ì‚­ì œ
```

### 3. ì‹œí¬ë¦¿ ëª¨ë“œë¡œ í…ŒìŠ¤íŠ¸

```
Ctrl+Shift+N (Chrome)
Cmd+Shift+N (Safari)
â†’ ì‹œí¬ë¦¿ ì°½ì—ì„œ ë¡œê·¸ì¸ ì¬ì‹œë„
```

### 4. ë¡œê·¸ í™•ì¸

**ë¸Œë¼ìš°ì € ì½˜ì†”**:
```
ê°œë°œì ë„êµ¬(F12) â†’ Console íƒ­
â†’ ì—ëŸ¬ ë©”ì‹œì§€ ì „ì²´ ë³µì‚¬
```

**Supabase ë¡œê·¸**:
```
Supabase Dashboard â†’ Logs â†’ Postgres
â†’ ìµœê·¼ ì—ëŸ¬ í™•ì¸
```

---

## ğŸ“š ì°¸ê³  ìë£Œ

- **ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ REST API ë¬¸ì„œ**: https://developers.kakao.com/docs/latest/ko/kakaologin/rest-api
- **í”„ë¡œì íŠ¸ ì†Œì…œ ë¡œê·¸ì¸ ê°€ì´ë“œ**: `web/markdown/SOCIAL_LOGIN_SETUP_GUIDE.md`
- **ëª¨ë°”ì¼ ë°°í¬ ê°€ì´ë“œ**: `web/markdown/MOBILE_DEPLOYMENT_NOTES.md`

---

## ğŸ“¸ ìŠ¤í¬ë¦°ìƒ· ê°€ì´ë“œ

### Redirect URI ë“±ë¡ í™”ë©´

ì¹´ì¹´ì˜¤ ê°œë°œì ì½˜ì†”ì—ì„œ ë‹¤ìŒê³¼ ê°™ì´ ë³´ì—¬ì•¼ í•©ë‹ˆë‹¤:

```
ì œí’ˆ ì„¤ì • > ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ > Redirect URI

Redirect URI
http://localhost:5173/auth/callback
https://your-domain.vercel.app/auth/callback
ingk://auth/callback

[+ Redirect URI ë“±ë¡]
```

---

**ìµœì¢… ì—…ë°ì´íŠ¸**: 2025-02-12
**ë¬¸ì œ í•´ê²° ì™„ë£Œ ì‹œ**: ì´ ë¬¸ì„œë¥¼ ì°¸ê³  ìë£Œë¡œ ë³´ê´€í•˜ì„¸ìš”!
