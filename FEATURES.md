# 통찰방 커뮤니티 - 기능 상세 가이드

이 문서는 통찰방 커뮤니티 플랫폼의 모든 기능을 상세히 설명합니다.

## 목차
1. [투표 시스템](#1-투표-시스템)
2. [오프라인 모임 시스템](#2-오프라인-모임-시스템)
3. [오늘의 질문 시스템](#3-오늘의-질문-시스템)
4. [인증 시스템](#4-인증-시스템)
5. [알림 시스템](#5-알림-시스템)
6. [관리자 기능](#6-관리자-기능)

---

## 1. 투표 시스템

### 1.1 투표 기간 생성 (관리자)

**위치**: `/admin/votes`

**기능**:
- 관리자가 커스텀 제목과 설명으로 투표 기간 생성
- 시작일과 종료일 지정
- 예시: "통찰방 10월-1 베스트 글 투표"

**사용 방법**:
1. 관리자 대시보드 → 투표 관리
2. "새 투표 기간 만들기" 버튼 클릭
3. 제목, 설명, 시작일, 종료일 입력
4. "투표 기간 생성" 버튼 클릭

**구현 코드**: `src/pages/admin/AdminVotesPage.jsx:56-102`

### 1.2 글 제출

**위치**: `/vote`

**기능**:
- 사용자가 투표 기간 동안 글 제출
- 제목, 작성자 이름, 본문 입력
- 작성자 이름: 원작자 또는 본인 이름

**사용 방법**:
1. 투표 페이지 접속
2. "글 제출하기" 버튼 클릭
3. 제목, 작성자, 본문 입력
4. "제출" 버튼 클릭

**주의사항**:
- 복사한 글인 경우 원작자 이름 입력
- 본인이 쓴 글인 경우 본인 이름 입력
- 작성자 필드는 필수 입력

**구현 코드**: `src/pages/voting/VotePage.jsx:217-232`

### 1.3 추천 투표 (1인 1표, 토글 방식)

**위치**: `/vote`

**기능**:
- 제출된 글에 추천 투표
- 1인당 1개 글에만 투표 가능
- 다시 클릭하면 투표 취소
- 실시간 추천수 표시

**사용 방법**:
1. 투표 페이지에서 글 목록 확인
2. "👍 추천" 버튼 클릭 (투표)
3. 다시 클릭하면 투표 취소
4. 버튼 색상: 초록색 = 투표함, 회색 = 투표 안 함

**구현 코드**: `src/pages/voting/VotePage.jsx:105-154`

### 1.4 우승자 자동 선정

**위치**: `/admin/votes`

**기능**:
- 투표 종료 시 최다 득표자 자동 선정
- 동점자 처리: 쉼표로 구분하여 모두 표시
- 예시: "홍길동, 김철수, 이영희"

**사용 방법**:
1. 관리자 대시보드 → 투표 관리
2. 모집 중인 투표 기간 찾기
3. "종료" 버튼 클릭
4. 우승자 자동 선정 및 표시

**구현 코드**: `src/pages/admin/AdminVotesPage.jsx:143-228`

### 1.5 관리자 글 목록 조회

**위치**: `/admin/votes`

**기능**:
- 투표 기간별 제출된 글 조회
- 추천수 순으로 정렬
- 순위, 제목, 작성자, 추천수 표시

**사용 방법**:
1. 관리자 대시보드 → 투표 관리
2. 투표 기간 목록에서 "글 보기" 버튼 클릭
3. 모달에서 추천수 순 글 목록 확인

**구현 코드**: `src/pages/admin/AdminVotesPage.jsx:230-317`

---

## 2. 오프라인 모임 시스템

### 2.0 공개 모임 조회 (v2.5.0)

**위치**: `/meetings`

**권한**: 로그인 불필요

**기능**:
- 로그인하지 않아도 모임 목록 조회 가능
- 모임 상세 정보 열람 가능
- 참가는 로그인 필요 (로그인 안내 표시)
- 비로그인 사용자에게 로그인 버튼 표시

**사용 방법**:
1. 브라우저에서 웹사이트 접속
2. 로그인 없이 "모임" 메뉴 클릭
3. 모임 목록 및 상세 정보 확인
4. 참가하려면 "로그인하고 참가하기" 버튼 클릭

**구현 코드**:
- `src/routes.jsx` (공개 라우트 설정)
- `src/pages/meetings/MeetingsPage.jsx`
- `src/pages/meetings/MeetingDetailPage.jsx`

### 2.1 모임 생성

**위치**: `/meetings/create`

**권한**: 관리자 또는 모임장 권한 필요

**기능**:
- 관리자 또는 모임장이 모임 생성 가능
- 커피 또는 술 모임 선택
- 장소, 날짜/시간, 최대 인원 설정
- **카카오톡 오픈채팅 링크 등록 (필수)** (v2.5.0)
- 모임 상세 설명 추가 (선택사항)
- Naver Map으로 장소 미리보기

**사용 방법**:
1. 오프라인 모임 페이지
2. "새 모임 만들기" 버튼
3. 장소, 날짜, 시간, 최대 인원 입력
4. 카카오톡 오픈채팅 링크 입력
5. 모임 상세 설명 작성 (선택)
6. 정보 확인 후 생성

**구현 코드**: `src/pages/meetings/CreateMeetingPage.jsx`

### 2.2 모임 참가 및 카카오톡 연동 (v2.5.0 업데이트)

**위치**: `/meetings/:id`

**기능**:
- 모임 상세 페이지에서 참가 신청
- 자동으로 익명 이름 부여 ("참가자1", "참가자2", ...)
- 참가 즉시 익명 채팅방 입장
- **참가 완료 시 카카오톡 오픈채팅방으로 자동 이동** (v2.5.0)
- 모임 상세 페이지에서 언제든 오픈채팅방 재입장 가능

**사용 방법**:
1. 모임 목록에서 원하는 모임 클릭
2. "모임 참가하기" 버튼 클릭
3. 자동으로 익명 채팅방 입장
4. 카카오톡 오픈채팅방이 새 탭에서 열림
5. 모임 상세 페이지의 "오픈채팅방 입장하기" 링크로 재입장 가능

**구현 코드**: `src/pages/meetings/MeetingDetailPage.jsx:268-307`

### 2.3 익명 채팅

**위치**: `/meetings/:id` (참가자만)

**기능**:
- 실시간 익명 채팅 (Supabase Realtime)
- 자동 익명 이름 부여
- 주최자는 왕관 이모지(👑)로 구분
- 자동 스크롤 (새 메시지 도착 시)

**사용 방법**:
1. 모임에 참가
2. 채팅 입력창에 메시지 입력
3. "전송" 버튼 클릭
4. 실시간으로 다른 참가자들과 대화

**주최자 구분**:
- 주최자 메시지: 노란 배경 + 왕관 이모지
- 일반 참가자: 흰 배경
- 본인 메시지: 파란 배경

**구현 코드**: `src/pages/meetings/MeetingDetailPage.jsx:348-404`

### 2.4 실시간 채팅 알림

**기능**:
- 다른 참가자가 메시지 보낼 때 웹 알림
- 알림 벨 아이콘에 미읽음 개수 표시
- 본인 메시지는 알림 없음

**구현 코드**: `src/pages/meetings/MeetingDetailPage.jsx:99-141`

### 2.5 모임 확정 (호스트/관리자)

**위치**: `/meetings/:id` (호스트 또는 관리자만)

**기능**:
- 모임장이 참가자 확정 후 더 이상 참가 신청을 받지 않음
- 모임 상태가 '모집 중' → '확정됨'으로 변경
- 확정 후 '모임 확정 취소' 버튼으로 다시 모집 가능
- 확정된 모임은 목록에서 '✅ 확정됨' 배지 표시

**사용 방법**:
1. 호스트 계정으로 로그인
2. 자신이 만든 모임 상세 페이지 이동
3. 채팅으로 참가자들과 확인 후
4. "모임 확정" 버튼 클릭
5. 필요시 "모임 확정 취소" 링크로 다시 모집 가능

**구현 코드**:
- 함수: `supabase/migrations/20250123_confirm_meeting_function_only.sql`
- UI: `src/pages/meetings/MeetingDetailPage.jsx`

### 2.6 모임 나가기

**위치**: `/meetings/:id` (참가자)

**기능**:
- 참가자가 모임에서 나갈 수 있음
- 나가기 전 확인 팝업 표시
- 모임장에게 퇴장 알림 전송
- 채팅 기록도 함께 삭제됨

**사용 방법**:
1. 참가한 모임 상세 페이지 이동
2. 장소 정보 옆 "모임 나가기" 버튼 클릭
3. 확인 팝업에서 "확인" 클릭
4. 모임에서 퇴장 처리됨

**주의사항**:
- 모임장은 모임을 나갈 수 없음 (모임 삭제만 가능)
- 나간 후 다시 참가하려면 재신청 필요

**구현 코드**:
- 함수: `supabase/migrations/20250123_fix_leave_meeting_function.sql`
- UI: `src/pages/meetings/MeetingDetailPage.jsx`

### 2.7 모임 수정 (호스트/관리자)

**위치**: `/meetings/:id` (호스트 또는 관리자만)

**기능**:
- 모임장 또는 관리자가 모임 정보 수정
- 장소, 시간, 최대 인원, 목적, 설명 수정 가능
- 현재 참가 인원보다 적은 최대 인원으로 변경 불가

**사용 방법**:
1. 호스트/관리자 계정으로 로그인
2. 모임 상세 페이지 이동
3. "✏️ 모임 수정" 버튼 클릭
4. 수정할 정보 입력
5. "수정" 버튼으로 저장

**구현 코드**: `src/pages/meetings/MeetingDetailPage.jsx`

### 2.8 관리자 모임 삭제

**위치**: `/meetings/:id` (관리자만)

**기능**:
- 관리자가 문제 있는 모임 삭제
- 채팅, 참가자, 모임 모두 삭제
- 되돌릴 수 없음 (주의)

**사용 방법**:
1. 관리자 계정으로 로그인
2. 모임 상세 페이지 이동
3. 하단의 "🗑️ 관리자: 모임 삭제" 버튼 클릭
4. 확인 대화상자에서 "확인" 클릭

**구현 코드**: `src/pages/meetings/MeetingDetailPage.jsx`

### 2.9 모임 참석 체크 (v2.5.0 신규)

**위치**: `/meetings/:id` (모임 종료 후, 모임장만)

**권한**: 모임장 또는 관리자

**기능**:
- 모임 종료 후 실제 참석자 체크
- 참석/미참석 상태 관리
- 참석 승인 시 참가자의 '모임 참여' 횟수 자동 증가
- 잘못 체크한 경우 다시 클릭하여 취소 가능
- 데이터베이스 함수 레벨에서 권한 검증

**사용 방법**:
1. 모임이 종료된 후 모임 상세 페이지 이동
2. 참가자 목록에서 "📝 참석 체크" 버튼 클릭
3. 실제로 참석한 참가자들의 "체크" 버튼 클릭
4. 체크된 참가자는 "✓ 참석" 상태로 변경됨
5. 잘못 체크한 경우 다시 클릭하여 취소

**주의사항**:
- 모임 종료 전에는 참석 체크 불가
- 모임장 본인은 체크 대상이 아님
- 참석 체크는 되돌릴 수 있음 (재클릭)

**구현 코드**:
- 함수: `supabase/migrations/20250128_add_meeting_participation_tracking.sql`
- UI: `src/pages/meetings/MeetingDetailPage.jsx:698-725`

### 2.10 모임 참여 횟수 추적 (v2.5.0 신규)

**위치**: `/profile`

**기능**:
- 사용자가 실제로 참석한 모임 횟수 추적
- 모임장이 참석 체크한 모임만 카운트
- 프로필 페이지의 "모임 참여" 통계에 표시
- 데이터베이스에서 자동 관리

**사용 방법**:
1. 프로필 페이지 접속
2. "활동 통계" 섹션에서 "모임 참여" 횟수 확인
3. 모임에 참석하고 모임장의 승인을 받으면 횟수 증가

**구현 코드**:
- DB 컬럼: `users.meeting_participation_count`
- UI: `src/pages/ProfilePage.jsx:115-120`

---

## 3. 오늘의 질문 시스템

### 3.1 질문 조회

**위치**: `/questions`

**권한**: 로그인 필요

**기능**:
- 매일 새로운 질문 확인
- 과거 질문 목록 조회
- 질문별 참여 현황 표시
- 질문 상세 페이지로 이동

**사용 방법**:
1. 로그인 후 "질문" 메뉴 클릭
2. 오늘의 질문 또는 과거 질문 선택
3. 질문 카드 클릭하여 상세 페이지 이동

**구현 코드**: `src/pages/questions/QuestionsPage.jsx`

### 3.2 개인 답변 작성 (체크인)

**위치**: `/questions/:id`

**기능**:
- 질문에 대한 개인적인 답변 작성
- 본인만 볼 수 있는 비공개 메모
- 질문 체크 완료 상태 저장
- 참여 인원 자동 집계

**사용 방법**:
1. 질문 상세 페이지에서 "✓ 체크하기" 버튼 클릭
2. 개인 답변 입력 (선택사항)
3. "저장" 버튼 클릭
4. 체크 완료 상태로 변경

**주의사항**:
- 개인 답변은 본인만 조회 가능
- 질문당 1회만 체크 가능
- 답변 내용은 수정 가능

**구현 코드**: `src/pages/questions/QuestionDetailPage.jsx`

### 3.3 공개 답변 작성

**위치**: `/questions/:id/write-answer`

**권한**: 로그인 필요

**기능**:
- 다른 사용자와 공유하는 공개 답변 작성
- 텍스트 또는 이미지(최대 2장) 업로드
- 별도의 전용 페이지에서 작성
- 질문 내용을 보면서 답변 작성 가능
- 한 질문당 하나의 공개 답변만 작성 가능

**사용 방법**:
1. 질문 상세 페이지에서 "✍️ 답변 작성하기" 버튼 클릭
2. 전용 답변 작성 페이지로 이동
3. 질문 내용 확인
4. 답변 입력:
   - 텍스트 답변: 최소 10자 이상
   - 이미지 업로드: 최대 2장, 5MB 이하
   - 텍스트와 이미지 동시 작성 가능
5. "✍️ 작성 완료" 버튼 클릭

**이미지 업로드 기능**:
- 지원 형식: JPG, PNG, GIF
- 최대 크기: 5MB per image
- 업로드 개수: 최대 2장
- 미리보기 제공
- 개별 이미지 삭제 가능

**구현 코드**: `src/pages/questions/WriteAnswerPage.jsx`

### 3.4 공개 답변 수정/삭제

**위치**: `/questions/:id/write-answer`

**기능**:
- 본인이 작성한 공개 답변 수정
- 텍스트 및 이미지 수정
- 답변 삭제 (댓글도 함께 삭제)

**사용 방법**:
1. 질문 상세 페이지에서 본인 답변 확인
2. "✏️ 내 답변 수정" 버튼 클릭
3. 답변 작성 페이지에서 내용 수정
4. "✏️ 수정 완료" 버튼 클릭

**주의사항**:
- 본인 답변만 수정/삭제 가능
- 답변 삭제 시 해당 답변의 모든 댓글도 삭제됨
- 삭제된 내용은 복구 불가

**구현 코드**: `src/pages/questions/WriteAnswerPage.jsx`

### 3.5 다른 사용자 답변 조회

**위치**: `/questions/:id`

**기능**:
- 질문에 대한 다른 사용자들의 공개 답변 조회
- 작성자 닉네임 및 작성 시간 표시
- 이미지가 포함된 답변 확인
- 답변별 댓글 목록 조회

**사용 방법**:
1. 질문 상세 페이지 접속
2. 하단의 "커뮤니티 답변" 섹션 확인
3. 다른 사용자들의 답변 조회
4. 답변에 달린 댓글 확인

**구현 코드**: `src/pages/questions/QuestionDetailPage.jsx`

### 3.6 댓글 작성

**위치**: `/questions/:id`

**기능**:
- 다른 사용자의 공개 답변에 댓글 작성
- 실시간 댓글 업데이트
- 작성자 닉네임 표시

**사용 방법**:
1. 다른 사용자의 답변에서 "댓글 달기" 버튼 클릭
2. 댓글 입력란에 내용 작성
3. "댓글 작성" 버튼 클릭
4. 실시간으로 댓글 표시

**구현 코드**: `src/pages/questions/QuestionDetailPage.jsx`

### 3.7 댓글 삭제

**위치**: `/questions/:id`

**기능**:
- 본인이 작성한 댓글 삭제
- 삭제 확인 팝업 제공

**사용 방법**:
1. 본인이 작성한 댓글 찾기
2. 댓글 우측 상단의 "삭제" 버튼 클릭
3. 확인 팝업에서 "확인" 클릭

**주의사항**:
- 본인 댓글만 삭제 가능
- 삭제된 댓글은 복구 불가

**구현 코드**: `src/pages/questions/QuestionDetailPage.jsx`

---

## 4. 인증 시스템

### 4.1 초대 코드 기반 회원가입

**위치**: `/signup`

**기능**:
- 6자리 영문 대문자 + 숫자 초대 코드로 회원가입
- 닉네임으로 중복 가입 방지
- 비밀번호 서버 사이드 bcrypt 해싱
- **초대 코드 만료**: 기존 사용자는 초대 코드 만료와 무관하게 계속 이용 가능
- 초대 코드는 회원가입 시에만 검증됨

**사용 방법**:
1. 회원가입 페이지 접속
2. 초대 코드 입력 (6자리 영문 대문자 + 숫자)
3. 닉네임, 비밀번호 입력
4. "회원가입" 버튼 클릭

**초대 코드 유효 기간**:
- 생성 후 7일간 유효
- 만료되어도 이미 가입한 사용자는 계속 로그인 가능
- 만료된 코드로는 새로운 회원가입 불가

**구현 코드**: `src/pages/auth/SignupPage.jsx`

### 4.2 로그인

**위치**: `/login`

**기능**:
- 닉네임과 비밀번호로 로그인
- 7일간 세션 유지
- localStorage 기반 세션 관리
- **공개 페이지**: 로그인 없이도 홈과 오프라인 모임 조회 가능 (v2.5.0)
- **보호 페이지**: 투표, 질문, 베스트 글은 로그인 필요
- **향상된 UX**: 비로그인 상태에서도 모든 메뉴 표시, 클릭 시 로그인 안내 (v2.5.1)

**사용 방법**:
1. 로그인 페이지 접속
2. 닉네임, 비밀번호 입력
3. "로그인" 버튼 클릭

**비로그인 사용자 경험 (v2.5.1)**:
1. 모든 메뉴가 네비게이션에 표시됨
2. 보호된 메뉴(질문, 투표, 베스트, 프로필) 클릭 시
3. "로그인 후 이용 부탁드립니다" 팝업 표시
4. 자동으로 로그인 페이지로 리다이렉션

**구현 코드**:
- `src/pages/auth/LoginPage.jsx`
- `src/components/common/MainLayout.jsx` (메뉴 네비게이션)

### 4.3 프로필 닉네임 수정

**위치**: `/profile`

**기능**:
- 사용자가 자신의 닉네임 변경 가능
- 중복 닉네임 검증
- 2-20자 길이 제한

**사용 방법**:
1. 프로필 페이지 접속
2. 닉네임 옆 "수정" 버튼 클릭
3. 새로운 닉네임 입력
4. "변경" 버튼으로 저장

**구현 코드**:
- 함수: `supabase/migrations/20250122_add_update_username_function.sql`
- UI: `src/pages/ProfilePage.jsx`

### 4.4 커스텀 인증 시스템

**기술 상세**:
- Supabase Auth 대신 커스텀 인증
- PostgreSQL 함수로 회원가입/로그인 처리
- `register_user()`: 비밀번호 해싱 후 사용자 생성
- `login_user()`: 비밀번호 검증 후 사용자 정보 반환
- `update_username()`: 닉네임 변경 및 중복 검증
- bcrypt 해싱 (pgcrypto 확장)

**구현 코드**: `setup_auth_functions.sql`

---

## 5. 알림 시스템

### 5.1 웹 기반 알림

**위치**: 상단 네비게이션 바 (알림 벨 아이콘)

**기능**:
- 브라우저 알림 대신 웹 기반 알림
- 미읽음 개수 표시 (빨간 배지)
- 알림 클릭 시 해당 페이지로 이동
- localStorage 기반 알림 지속성

**알림 유형**:
- **채팅 알림**: 다른 사용자가 메시지 보냄
  - 표시: "새 채팅 메시지"
  - 내용: "참가자X: 메시지 내용"
  - 클릭 시 해당 모임 페이지로 이동
- **모임 퇴장 알림**: 참가자가 모임에서 나감 (모임장에게만)
  - 표시: "모임 참가자 퇴장"
  - 내용: "참가자X님이 모임에서 나갔습니다."
  - 클릭 시 해당 모임 페이지로 이동

**사용 방법**:
1. 상단 알림 벨 아이콘 확인
2. 미읽음 알림이 있으면 빨간 배지 표시
3. 아이콘 클릭하여 알림 목록 확인
4. 알림 클릭 시 해당 페이지로 이동

**구현 코드**:
- Store: `src/store/notificationStore.js`
- 컴포넌트: `src/components/common/NotificationBell.jsx`

### 5.2 알림 관리

**기능**:
- 개별 알림 삭제
- 모든 알림 읽음 처리
- 모든 알림 삭제
- 읽음/미읽음 구분 표시

**사용 방법**:
1. 알림 벨 클릭하여 드롭다운 열기
2. "모두 읽음 처리" 버튼으로 모든 알림 읽음 처리
3. "모두 삭제" 버튼으로 모든 알림 삭제
4. 개별 알림의 "X" 버튼으로 개별 삭제

**구현 코드**: `src/store/notificationStore.js`

---

## 6. 관리자 기능

### 6.1 회원 관리

**위치**: `/admin/users`

**기능**:
- 전체 회원 목록 조회
- 회원 활성화/비활성화
- 회원 역할 관리 (user, meeting_host, admin)
- 회원 정보 확인 (닉네임, 가입일, 상태, 역할)

**사용 방법**:
1. 관리자 대시보드 → 회원 관리
2. 회원 목록 확인
3. 활성화/비활성화 버튼으로 상태 변경
4. 역할 드롭다운으로 권한 변경

**구현 코드**: `src/pages/admin/AdminUsersPage.jsx`

### 6.2 초대 코드 관리

**위치**: `/admin/invites`

**기능**:
- 6자리 숫자 초대 코드 생성
- 유효 기간: 7일
- 코드 무효화 (만료일을 과거로 변경)
- 코드 삭제 (사용되지 않은 코드만)

**사용 방법**:

#### 코드 생성
1. 관리자 대시보드 → 초대 코드 관리
2. 생성 개수 입력 (1-100)
3. "생성하기" 버튼 클릭
4. 생성된 코드를 사용자에게 전달

#### 코드 무효화
1. 초대 코드 목록에서 "무효화" 버튼 클릭
2. 확인 대화상자에서 "확인" 클릭
3. 코드가 즉시 만료됨 (사용 불가)

#### 코드 삭제
1. 사용되지 않은 코드에서 "삭제" 버튼 클릭
2. 확인 대화상자에서 "확인" 클릭
3. 코드가 완전히 삭제됨 (되돌릴 수 없음)

**주의사항**:
- 사용된 코드는 삭제할 수 없음 (무효화만 가능)
- 무효화는 되돌릴 수 없음
- 삭제는 완전히 제거되어 복구 불가

**구현 코드**: `src/pages/admin/AdminInvitesPage.jsx`

### 6.3 투표 관리

**위치**: `/admin/votes`

**기능**:
- 투표 기간 생성 (제목/설명 커스터마이징)
- 투표 기간 종료 (우승자 자동 선정)
- 제출된 글 추천수 순 조회
- 우승자 표시 (동점 처리)

**사용 방법**:
1. 관리자 대시보드 → 투표 관리
2. 투표 기간 목록 확인
3. "새 투표 기간 만들기" 또는 "종료" 버튼 사용
4. "글 보기" 버튼으로 제출된 글 확인

**구현 코드**: `src/pages/admin/AdminVotesPage.jsx`

### 6.4 커뮤니티 통계

**위치**: `/admin` (대시보드)

**기능**:
- 전체 회원 수
- 활성 회원 수
- 진행 중인 투표 수
- 예정된 모임 수

**구현 코드**: `src/pages/admin/AdminPage.jsx`

---

## 기술 구현 상세

### 1. RLS (Row Level Security) 정책

모든 테이블에 RLS 적용:
- 커스텀 인증 시스템 사용으로 인해 permissive 정책 사용
- `FOR ALL USING (true) WITH CHECK (true)`
- 서버 사이드에서 권한 검증

### 2. Realtime 구독

채팅에 Supabase Realtime 사용:
```javascript
const channel = supabase
  .channel(`meeting-${id}`)
  .on('postgres_changes', {
    event: 'INSERT',
    schema: 'public',
    table: 'meeting_chats',
    filter: `meeting_id=eq.${id}`,
  }, (payload) => {
    // 새 메시지 처리
    setChats((prev) => [...prev, payload.new])
  })
  .subscribe()
```

### 3. 상태 관리 (Zustand)

전역 상태 관리:
- `authStore`: 사용자 인증 상태
- `notificationStore`: 알림 상태

### 4. 커스텀 인증

PostgreSQL 함수로 인증 처리:
```sql
CREATE OR REPLACE FUNCTION register_user(
  p_username TEXT,
  p_password TEXT,
  p_kakao_nickname TEXT,
  p_invite_code TEXT
) RETURNS JSON
SECURITY DEFINER
SET search_path = public
LANGUAGE plpgsql AS $$
-- 비밀번호 해싱 및 사용자 생성
$$;
```

---

## 문제 해결

### 채팅이 보이지 않는 경우
1. 모임에 참가했는지 확인
2. 브라우저 새로고침
3. 콘솔에서 Realtime 구독 상태 확인

### 투표가 안 되는 경우
1. 투표 기간이 진행 중인지 확인
2. 이미 다른 글에 투표했는지 확인
3. 브라우저 새로고침

### 알림이 오지 않는 경우
1. localStorage가 활성화되어 있는지 확인
2. 브라우저 콘솔에서 에러 확인
3. 알림 벨 아이콘 클릭하여 수동 확인

### 초대 코드 삭제가 안 되는 경우
1. 사용된 코드인지 확인 (사용된 코드는 무효화만 가능)
2. RLS 정책 확인 (`fix_invitation_codes_rls.sql` 실행)
3. 콘솔에서 에러 메시지 확인

---

## 최근 업데이트 (2025년 1월 23일)

### 새로 추가된 기능

1. **프로필 닉네임 수정**
   - 사용자가 직접 닉네임 변경 가능
   - 중복 검증 및 길이 제한
   - PostgreSQL 함수로 안전하게 처리

2. **모임장 권한 시스템**
   - 새로운 `meeting_host` 역할 추가
   - 관리자 또는 모임장만 모임 생성 가능
   - 모임장은 자신의 모임만 수정 가능

3. **모임 확정 기능**
   - 모임장이 참가자 확정 후 신청 마감
   - 확정 취소로 다시 모집 가능
   - 확정 상태 배지 표시

4. **모임 나가기 기능**
   - 참가자가 모임에서 자유롭게 퇴장
   - 모임장에게 퇴장 알림 전송
   - 채팅 기록 자동 삭제

5. **모임 상세 설명**
   - 모임 생성 시 상세 설명 추가 가능
   - 모임 상세 페이지에 설명 표시
   - 모임 수정 시 설명 변경 가능

6. **모임 수정 기능**
   - 모임장/관리자가 모임 정보 수정
   - 장소, 시간, 인원, 목적, 설명 변경
   - 모달 UI로 편리한 수정

### 데이터베이스 마이그레이션

최근 적용된 마이그레이션:
- `20250122_add_update_username_function.sql`: 닉네임 변경 함수
- `20250123_fix_meeting_status_constraint.sql`: 모임 상태 제약 조건 수정
- `20250123_confirm_meeting_function_only.sql`: 모임 확정 함수
- `20250123_add_unconfirm_meeting_function.sql`: 모임 확정 취소 함수
- `20250123_fix_leave_meeting_function.sql`: 모임 나가기 함수 (수정)
- `20250123_add_meeting_description.sql`: 모임 설명 컬럼 추가

## 추가 개선 가능 사항

1. ~~**모임 수정 기능** (호스트 전용)~~ ✅ 완료
2. **참가자 강제 퇴장** (관리자/호스트)
3. **메시지 삭제** (본인 메시지만)
4. **읽음 표시** (누가 메시지를 읽었는지)
5. **타이핑 표시** (누가 입력 중인지)
6. **이미지/파일 전송**
7. **이모지 반응**
8. **메시지 검색**
9. **모바일 반응형**
10. **PWA 지원**

---

## 최근 업데이트 (v2.5.0 - 2025년 10월 28일)

### 새로 추가된 기능

1. **로그인 없이 공개 콘텐츠 접근**
   - 홈 페이지 누구나 접근 가능
   - 오프라인 모임 목록 및 상세 정보 조회 가능
   - 비로그인 사용자를 위한 환영 배너
   - 네비게이션 바 동적 메뉴 (로그인 상태에 따라 변경)

2. **카카오톡 오픈채팅 링크 연동**
   - 모임 생성 시 오픈채팅 링크 필수 등록
   - 참가 시 자동으로 오픈채팅방 이동
   - 모임 상세 페이지에서 언제든 입장 가능
   - 링크 유효성 검증

3. **모임 참석 체크 시스템**
   - 모임 종료 후 모임장이 실제 참석자 체크
   - 참석/미참석 상태 관리
   - 데이터베이스 함수 레벨 권한 검증
   - 체크 취소 가능

4. **모임 참여 횟수 추적**
   - 참석 승인 시 프로필에 자동 반영
   - `users.meeting_participation_count` 컬럼 추가
   - 음수 방지 로직 적용
   - 프로필 페이지에 통계 표시

### 데이터베이스 마이그레이션

최근 적용된 마이그레이션:
- `20250128_add_kakao_openchat_link.sql`: 카카오톡 오픈채팅 링크 컬럼 추가
- `20250128_add_meeting_participation_tracking.sql`: 모임 참여 횟수 추적 시스템

---

**최종 업데이트**: 2025년 10월 28일 (v2.5.1)

---

## 📝 최근 업데이트 내역

### v2.5.1 (2025-10-28)

1. **비로그인 사용자 UX 개선**
   - 모든 메뉴를 비로그인 사용자에게도 표시
   - 보호된 메뉴 클릭 시 로그인 안내 팝업 및 리다이렉션
   - Desktop, Mobile Sidebar, Mobile Bottom Navigation 모두 적용
   - 코드 위치: `src/components/common/MainLayout.jsx:22-28` (handleProtectedLinkClick)

2. **홈 페이지 모임 표시 개수 확대**
   - 모집 중인 모임 표시: 3개 → 6개
   - 코드 위치: `src/pages/HomePage.jsx:51` (.limit(6))

3. **초대 코드 시스템 명확화**
   - 초대 코드 만료되어도 기존 사용자는 계속 이용 가능
   - 초대 코드는 회원가입 시에만 검증됨
   - 관련 코드: `setup_auth_functions.sql:23-36` (register_user 함수)
